---
metadata:
  description:
  credits:
certificate_names:
  dcrt: device certificate
  dcrt-oid: device owner certificate
  lcrt: Lynx / Secure Storage for SEP Certificate
  pcrt: product/production certificate?
  rcrt: remote/recovery certificate?
  scrt: SEP Certificate
  tcrt: test certificate?
  ucrt: user certificate (mapps to a single iCloud account)
  vcrt: virtual certificate?
keys:
  uik:
    description: User Identity Key
  sik:
    description: System Identity Key
  oik:
    description: Owner Identity Key (the first password after restore)
constants:
  private_oid_root: 1.2.840.113635
oids:
  - oid: 1.2.840.113635.100.6.17
    description: Contains the name of the key
  - oid: 1.2.840.113635.100.5.3
    apple_description: ADC Certificate Policy
  - oid: 1.2.840.113635.100.5.4
    apple_description: Markers for iPhone OS Device Certificate Policies, used for external sources to trust iPhone OS devices
  - oid: 1.2.840.113635.100.5.4.1
    apple_description: BBC's Policy
  - oid: 1.2.840.113635.100.6.1.1
    apple_description: Apple Released Code Signature
  - oid: 1.2.840.113635.100.6.1.2
    apple_description: Apple World Wide Developer Relations Certificates for Code Signing during development
  - oid: 1.2.840.113635.100.6.1.3
    apple_description: Apple World Wide Developer Relations Certificates for Code Signing for General Release through the iTMS
  - oid: 1.2.840.113635.100.6.1.3.1
    apple_description: Apple World Wide Developer Relations Certificates for Code Signing for Test Release through the iTMS
  - oid: 1.2.840.113635.100.6.1.4
    apple_description: Apple World Wide Developer Relations Certificates for Code Signing GM from developer to Apple
  - oid: 1.2.840.113635.100.6.16
    description:
      A sequence of FDR programming commands, seperated by ";".  Each command is "PUT" or "GET" prior to a
      4CC value, followed by a ":" then the value of the key.
    example:
      PUT/FSCl:sik-FXFYFXFFYFFEX-QQRRRDEETFEFYCEIESLIREILCILESCLSELRESERSER
  - oid: 1.2.840.113635.100.6.1.15
    name: TSS Signing Delegation Constraints
    description:
      Constriction on values that can be specified or signed by this certificate.  Conatins two sub-sequesnces, the MANP (Manifest Properties)
      and the OBJP (Object Properties).  Manifest properties are at the issued IM4M, and object properties are per signed object (firmware).
      Values of NULL mean tha tthis certificate can sign any value for that property, values that are set are values that must be signed
      with that value by this certificate.  This is how for example `T6031-SDOM1` is enforced.  The certificate for that set of servers
      have a null value for ECID (meaning it can be used for any ECID) and have fixed values for CHIP / Security Domain SDOM.

      This is how Live TSS for customers differs from factory signing in what properties it can include.  Factory only manifest properties
      include `augs`, `uidm`
    found_in:
      - ucrt
      - dcrt-oid
    issuers:
      - Basic Attestation User Sub CA2
      - FDRDC-UCRT-SUBCA
      - T6031-SDOM1-TssLive-ManifestKey-RevA-Factory
    ous:
      - BAA Certification
      - ucrt Leaf Certificate
  - oid: 1.2.840.113635.100.6.2.1
    apple_description: Marker for the WWDR Intermediate Certificate
  - oid: 1.2.840.113635.100.6.2.2
    apple_description: Marker for the iTunes Store Intermediate Certificate
  - oid: 1.2.840.113635.100.6.3.1
    apple_description: Apple World Wide Developer Relations Client SSL Certificates for Accessing the Development Apple Push Service
  - oid: 1.2.840.113635.100.6.3.2
    apple_description: Apple World Wide Developer Relations Client SSL Certificates for Accessing the Production Apple Push Service
  - oid: 1.2.840.113635.100.6.4.1
    apple_description: Extension Markers for device version string, expects UTF8 to follow in SubjectAltName
  - oid: 1.2.840.113635.100.6 4.2
    apple_description: Extension Markers for OS version string, expects UTF8 to follow in SubjectAltName
  - oid: 1.2.840.113635.100.6.5.1
    apple_description: Apple iTunes Store Certificates for Signing Receipts of Purchases from the iTS
  - oid: 1.2.840.113635.100.6.5.2
    apple_description: Apple iTunes Store Certificates for Signing Requests to Purchase for the iTS
  - oid: 1.2.840.113635.100.7.1.1
    apple_description: 'Apple FairPlay certificate extended Application Authentication & Authorization: Policy'
  - oid: 1.2.840.113635.100.8.4
    description: Contains a sequence of integer values.  Some are 0, some are 1, others appear to be int32 bitmasks.
    is_asn_body: true
    is_extension: true
    found_in:
      - dcrt
      - dcrt-oid
    issuers:
      - Basic Attestation User Sub CA2
    ous:
      - BAA Certification
  - oid: 1.2.840.113635.100.8.5
    description: Similar in nature to `1.2.840.113635.100.8.4`. Non-integer values observed of `ssca`.
    is_asn_body: true
    is_extension: true
    found_in:
      - dcrt
      - dcrt-oid
    issuers:
      - Basic Attestation User Sub CA2
    ous:
      - BAA Certification
  - oid: 1.2.840.113635.100.8.7
    description: ASN1 data for the version of macOS for the issued under (e.g. 12.2)
    is_asn_body: true
    is_extension: true
    found_in:
      - dcrt
      - dcrt-oid
    issuers:
      - Basic Attestation User Sub CA2
    ous:
      - BAA Certification
  - oid: 1.2.840.113635.100.10.1
    description:
      Hardware device identifiers of the machine the certificate is issued to
      contains BORD, CHIP, ECID, srnm, udid, seid
    found_in:
      - ucrt
    issuers:
      - FDRDC-UCRT-SUBCA
    ous:
      - ucrt Leaf Certificate
  - oid: 1.2.840.113635.100.10.2
    found_in:
      - ucrt
    issuers:
      - FDRDC-UCRT-SUBCA
    ous:
      - ucrt Leaf Certificate
known_symbols:
  ekus:
    - _oidAppleExtendedKeyUsageAppleID
    - _oidAppleExtendedKeyUsageCodeSigning
    - _oidAppleExtendedKeyUsageCodeSigningDev
    - _oidAppleExtendedKeyUsagePassbook
    - _oidAppleExtendedKeyUsageProfileSigning
    - _oidAppleExtendedKeyUsageQAProfileSigning
  purposes:
    - _oidAppleApplicationSigning
    - _oidAppleProvisioningProfile
    - _oidAppleInstallerPackagingSigningExternal
    - _oidApplePushServiceClient
  extensions:
    - _oidAppleCertExtAST2DiagnosticsServerAuthProd
    - _oidAppleCertExtAST2DiagnosticsServerAuthProdQA
    - _oidAppleCertExtATVAppSigningProd
    - _oidAppleCertExtATVAppSigningProdQA
    - _oidAppleCertExtATVVPNProfileSigning
    - _oidAppleCertExtApplePPQSigningProd
    - _oidAppleCertExtApplePPQSigningProdQA
    - _oidAppleCertExtAppleSMPEncryption
    - _oidAppleCertExtAppleServerAuthentication
    - _oidAppleCertExtAppleServerAuthenticationAPNProd
    - _oidAppleCertExtAppleServerAuthenticationAPNProdQA
    - _oidAppleCertExtAppleServerAuthenticationGS
    - _oidAppleCertExtAppleServerAuthenticationIDSProd
    - _oidAppleCertExtAppleServerAuthenticationIDSProdQA
    - _oidAppleCertExtAppleServerAuthenticationMMCSProd
    - _oidAppleCertExtAppleServerAuthenticationMMCSProdQA
    - _oidAppleCertExtAppleServerAuthenticationPPQProd
    - _oidAppleCertExtAppleServerAuthenticationPPQProdQA
    - _oidAppleCertExtAppleServerAuthenticationiCloudSetupProd
    - _oidAppleCertExtAppleServerAuthenticationiCloudSetupProdQA
    - _oidAppleCertExtCryptoServicesExtEncryption
    - _oidAppleCertExtEscrowProxyServerAuthProd
    - _oidAppleCertExtEscrowProxyServerAuthProdQA
    - _oidAppleCertExtFMiPServerAuthProd
    - _oidAppleCertExtFMiPServerAuthProdQA
    - _oidAppleCertExtHomeKitServerAuth
    - _oidAppleCertExtOSXProvisioningProfileSigning
    - _oidAppleCertExtTrustCacheSigning
    - _oidAppleCertExtTrustCacheSigningTest
    - _oidAppleCertExtensionAppleIDRecordValidationSigning
  unknown:
    - _oidAppleImg4ManifestCertSpec
    - _oidAppleIntmMarkerAppleHomeKitServerCA
    - _oidAppleIntmMarkerAppleID
    - _oidAppleIntmMarkerAppleID2
    - _oidAppleIntmMarkerAppleServerAuthentication
    - _oidAppleIntmMarkerAppleSystemIntg2
    - _oidAppleIntmMarkerAppleSystemIntgG3
    - _oidAppleIntmMarkerAppleWWDR
    - _oidApplePolicyEscrowService
    - _oidApplePolicyMobileStore
    - _oidApplePolicyMobileStoreProdQA
    - _oidAppleSecureBootCertSpec
    - _oidAppleSecureBootTicketCertSpec
    - _oidAppleTVOSApplicationSigningProd
    - _oidAppleTVOSApplicationSigningProdQA
roots:
  FDR-CA1-ROOT-CM:
  FDR-DC-SSL-ROOT:
  FDR Sealing Server CA 1:
    subordinate_cas:
      FDR-SS-CM-E1:
  Basic Attestation User Root CA:
    subordinate_cas:
      Basic Attestation User Sub CA2:
        description:
          Issues `ucrt` subordinate CA's that are used for user level signing.  Under this `BAA Certification`
          certs are issued.
  Apple Secure Boot Root CA - G6:
    subordinate_cas:
      T6031-SDOM1-RecoveryBoot-RevA-Factory:
        description:
      T6031-SDOM1-TssLive-ManifestKey-RevA-Factory:
  Apple X86 Secure Boot Root CA - G1:
    subject_key_id: 301680147D73CE0A3B41A1A352D2B1141EF6F5B4DD76E6E8
    subordinate_cas:
      T6031-SDOM1-TssLive-ManifestKey-Global-RevA-DataCenter:
        subject_key_id: 0414D8B9E3E9C4A1C542ECB72FC2CF0C2F861E1B3EEF
  Apple Extra Content Global Root CA - G1:
    subject_key_id: 30168014AA63251D082C72A381536C94D2864995881CB0D0
    subordinate_cas:
      ZFF10-SDOM1-TssLive-ManifestKey-ExtraContent-Global-RevA-DataCenter:
        subject_key_id: 041442FEAB470561CE2A7471B55AC0D81AB7536F4B36